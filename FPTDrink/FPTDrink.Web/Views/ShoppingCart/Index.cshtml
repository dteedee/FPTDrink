@model FPTDrink.Web.ViewModels.CartViewModel
@{
	ViewData["Title"] = "Giỏ hàng";
	var total = Model.Items.Sum(i => i.TotalPrice);
}

@section Styles {
    <style>
        .cart-section .form-control {
            border: 2px solid rgba(212, 165, 116, 0.3);
            border-radius: 8px;
            background: #ffffff;
            color: #2d1b0e;
            transition: all 0.3s ease;
        }

        .cart-section .form-control:focus {
            border-color: #d4a574;
            box-shadow: 0 0 0 0.2rem rgba(212, 165, 116, 0.25);
            background: #ffffff;
        }

        .cart-section .input-group .form-control {
            border-right: none;
            border-radius: 8px 0 0 8px;
        }

        .cart-section .btn-outline-primary {
            background: linear-gradient(135deg, rgba(212, 165, 116, 0.1) 0%, rgba(139, 90, 43, 0.05) 100%);
            border: 2px solid #d4a574;
            color: #d4a574;
            border-radius: 0 8px 8px 0;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .cart-section .btn-outline-primary:hover {
            background: linear-gradient(135deg, #d4a574 0%, #f0c896 100%);
            border-color: #d4a574;
            color: #1a0f08;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(212, 165, 116, 0.3);
        }

        .cart-section .btn-outline-danger {
            border: 2px solid rgba(220, 53, 69, 0.3);
            color: #dc3545;
            background: linear-gradient(135deg, rgba(220, 53, 69, 0.1) 0%, rgba(220, 53, 69, 0.05) 100%);
            transition: all 0.3s ease;
        }

        .cart-section .btn-outline-danger:hover {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            border-color: #dc3545;
            color: #ffffff;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(220, 53, 69, 0.3);
        }

        .cart-section .btn-outline-secondary {
            border: 2px solid rgba(212, 165, 116, 0.3);
            color: #2d1b0e;
            background: linear-gradient(135deg, rgba(212, 165, 116, 0.1) 0%, rgba(139, 90, 43, 0.05) 100%);
            border-radius: 10px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .cart-section .btn-outline-secondary:hover {
            background: linear-gradient(135deg, #d4a574 0%, #f0c896 100%);
            border-color: #d4a574;
            color: #1a0f08;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(212, 165, 116, 0.3);
        }

        .cart-section .btn-primary {
            background: linear-gradient(135deg, #d4a574 0%, #f0c896 100%);
            border: none;
            color: #1a0f08;
            font-weight: 700;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(212, 165, 116, 0.4);
            transition: all 0.3s ease;
        }

        .cart-section .btn-primary:hover {
            background: linear-gradient(135deg, #f0c896 0%, #d4a574 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(212, 165, 116, 0.5);
        }
    </style>
}

<section class="products-section cart-section">
	<div class="section-header">
		<h2><i class="bx bx-cart"></i>Giỏ hàng của bạn</h2>
		<p class="mb-0">Kiểm tra và chỉnh sửa các sản phẩm trong giỏ hàng</p>
	</div>

@if (Model.Items.Count == 0)
{
		<div class="alert alert-info text-center">
			<i class="bx bx-cart me-2"></i>Giỏ hàng của bạn đang trống. 
			<a asp-controller="Menu" asp-action="Index" class="alert-link">Tiếp tục mua sắm</a>
		</div>
}
else
{
		<div class="card border-0 shadow-sm" style="background: linear-gradient(135deg, #faf8f5 0%, #f5f0e8 100%); border: 2px solid rgba(212, 165, 116, 0.25) !important; border-radius: 16px; overflow: hidden;">
	<div class="table-responsive">
				<table class="table align-middle mb-0">
					<thead style="background: linear-gradient(135deg, rgba(212, 165, 116, 0.1) 0%, rgba(139, 90, 43, 0.05) 100%);">
				<tr>
							<th style="width:72px" class="border-0"></th>
							<th class="border-0" style="color: #2d1b0e; font-weight: 700;">Sản phẩm</th>
							<th style="width:120px" class="text-end border-0" style="color: #2d1b0e; font-weight: 700;">Giá</th>
							<th style="width:160px" class="text-center border-0" style="color: #2d1b0e; font-weight: 700;">Số lượng</th>
							<th style="width:140px" class="text-end border-0" style="color: #2d1b0e; font-weight: 700;">Thành tiền</th>
							<th style="width:80px" class="border-0"></th>
				</tr>
			</thead>
			<tbody>
				@foreach (var item in Model.Items)
				{
							<tr style="border-bottom: 1px solid rgba(212, 165, 116, 0.2);">
						<td>
									<img src="@(string.IsNullOrWhiteSpace(item.ProductImg) ? Url.Content("~/images/placeholder.png") : item.ProductImg)" 
									     class="rounded object-fit-cover" 
									     style="height:64px;width:64px;object-fit:cover; border: 2px solid rgba(212, 165, 116, 0.3);" />
						</td>
						<td>
									<div class="fw-bold" style="color: #2d1b0e;">@item.ProductName</div>
								</td>
								<td class="text-end">
									<span class="text-primary fw-bold">@string.Format("{0:N0} ₫", item.Price)</span>
						</td>
						<td class="text-center">
							<form class="d-inline-block" method="post" asp-action="Update">
								<input type="hidden" name="productId" value="@item.ProductId" />
								<div class="input-group input-group-sm" style="max-width: 140px;">
											<input class="form-control text-center" 
											       name="quantity" 
											       type="number" 
											       min="0" 
											       value="@item.Quantity"
											       style="border: 1px solid rgba(212, 165, 116, 0.3); border-radius: 8px 0 0 8px;" />
											<button class="btn btn-outline-primary" 
											        type="submit"
											        style="border-radius: 0 8px 8px 0; border-left: none;">
												<i class="bx bx-check"></i>
											</button>
								</div>
							</form>
						</td>
								<td class="text-end">
									<span class="text-primary fw-bold">@string.Format("{0:N0} ₫", item.TotalPrice)</span>
								</td>
						<td class="text-end">
							<form method="post" asp-action="Remove">
								<input type="hidden" name="productId" value="@item.ProductId" />
										<button class="btn btn-sm btn-outline-danger" type="submit">
											<i class="bx bx-trash"></i>
										</button>
							</form>
						</td>
					</tr>
				}
			</tbody>
					<tfoot style="background: linear-gradient(135deg, rgba(212, 165, 116, 0.1) 0%, rgba(139, 90, 43, 0.05) 100%);">
				<tr>
							<td colspan="4" class="text-end fw-bold border-0" style="color: #2d1b0e; font-size: 1.1rem;">Tổng cộng</td>
							<td class="text-end fw-bold border-0" style="color: #d4a574; font-size: 1.25rem;">@string.Format("{0:N0} ₫", total)</td>
							<td class="border-0"></td>
				</tr>
			</tfoot>
		</table>
	</div>
		</div>
		
		<div class="d-flex gap-2 mt-4 flex-wrap">
		<form method="post" asp-action="Clear">
				<button class="btn btn-outline-secondary" type="submit">
					<i class="bx bx-x me-1"></i>Xoá giỏ hàng
				</button>
		</form>
			<a class="btn btn-primary ms-auto" asp-controller="Checkout" asp-action="Index">
				<i class="bx bx-credit-card me-1"></i>Thanh toán
			</a>
	</div>
}
</section>
